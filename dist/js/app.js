function initMap(){var e={lat:47.610984,lng:-122.337031};map=new google.maps.Map(document.getElementById("map-container"),{zoom:13,center:e}),infoWindow=new google.maps.InfoWindow,createMarkers()}function mapError(){document.getElementById("map-container").innerText="Unable to load map"}function createMarkers(){museums.forEach(function(e){var n=new google.maps.Marker({position:{lat:e.lat,lng:e.lng},map:map,title:e.name,animation:google.maps.Animation.DROP});n.addListener("click",function(){bounceMarker(n),showInfoWindow(n)}),markers.push(n)})}function showInfoWindow(e){var n="https://api.foursquare.com/v2/venues/search";n+="?"+$.param({client_id:myFoursquareKey.client_id,client_secret:myFoursquareKey.client_secret,v:"20170910",intent:"match",query:e.getTitle(),ll:e.getPosition().lat().toString()+","+e.getPosition().lng().toString()}),$.ajax({url:n,method:"GET"}).done(function(n){var o="";try{o+="<div><h6>"+e.title+"</h6>",n.response.venues[0].location.formattedAddress&&(o+="<p><b>Address: </b>"+n.response.venues[0].location.formattedAddress+"</p>"),n.response.venues[0].contact.formattedPhone&&(o+="<p><b>Phone: </b>"+n.response.venues[0].contact.formattedPhone+"</p>"),n.response.venues[0].url&&(o+='<p><b>URL: </b><a href="'+n.response.venues[0].url+'">',o+=n.response.venues[0].url+"</a></p>"),o+='<p>Power by: <a href="https://api.foursquare.com">Foursquare API</a></p></div>'}catch(n){o="<h6>"+e.getTitle()+"</h6><p>Failed to get information of location from foursquare.com</p>"}infoWindow.setContent(o),infoWindow.open(map,e)}).fail(function(n){console.error(n);var o="<h6>"+e.getTitle()+"</h6><p>Failed to get information of location from foursquare.com</p>";infoWindow.setContent(o),infoWindow.open(map,e)})}function bounceMarker(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1400)}var markers=[],map,infoWindow,ViewModel=function(){this.leftPanelDisplayed=ko.observable(!0),this.hideLeftPanel=function(){this.leftPanelDisplayed(!1)},this.showLeftPanel=function(){this.leftPanelDisplayed(!0)},this.displayedMuseums=ko.observableArray(museums.slice()),this.museumClicked=function(e){markers.forEach(function(n){n.title===e.name&&(bounceMarker(n),showInfoWindow(n))})},this.filterText=ko.observable(""),this.filterTextChanged=function(){var e=this.filterText().trim().toLowerCase();if(this.displayedMuseums.removeAll(),""===e){for(var n=0;n<museums.length;n++)this.displayedMuseums.push(museums[n]);markers.forEach(function(e){e.setMap(map)})}else{for(var o=0;o<museums.length;o++)museums[o].name.toLowerCase().includes(e)&&this.displayedMuseums.push(museums[o]);markers.forEach(function(n){n.title.toLowerCase().includes(e)?n.setMap(map):n.setMap(null)})}}};ko.applyBindings(new ViewModel);